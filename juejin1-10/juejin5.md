# 德州扑克葫芦问题

## 题目描述

在德州扑克游戏中，"葫芦"是一种特殊的牌型，由三张相同牌面值的牌(a)和两张相同牌面值的牌(b)组成。本题对传统葫芦增加了一个限制条件：组成葫芦的五张牌的牌面值之和不能超过给定的最大值max。

### 牌面值规则
- 1(A) > K(13) > Q(12) > J(11) > 10 > 9 > ... > 2
- A的牌面值为1，K为13，以此类推

### 比较规则
当两个葫芦比较大小时：
1. 优先比较三张相同牌(a)的大小
2. 如果三张牌相同，则比较对子(b)的大小

## 输入格式
- n: 数组长度
- max: 五张牌的和的最大值限制
- array: 包含n个整数的数组，表示所有的牌

## 输出格式
返回一个长度为2的数组[x, y]：
- x: 最大合法葫芦中的三张牌的牌面值
- y: 最大合法葫芦中的对子的牌面值
- 如果找不到合法的葫芦，返回[0, 0]

## 示例
```python
输入：n = 9, max = 34, array = [6, 6, 6, 8, 8, 8, 5, 5, 1]
输出：[8, 5]
解释：可组成的葫芦有：
- [6,6,6,8,8] 
- [6,6,6,5,5]
- [8,8,8,6,6]
- [8,8,8,5,5]
其中[8,8,8,6,6]的和为36>34不合法，
在剩余合法组合中[8,8,8,5,5]最大。

输入：n = 9, max = 37, array = [9, 9, 9, 9, 6, 6, 6, 6, 13]
输出：[6, 9]
解释：[9,9,9,6,6]的和为39>37不合法，
所以返回次大的组合[6,6,6,9,9]。
```

## 解题思路

1. 统计每个数字出现的次数
   - 使用字典记录每个牌面值出现的次数
   
2. 找出所有可能的三张牌组合和对子
   - 出现次数≥3的可以作为三张牌
   - 出现次数≥2的可以作为对子

3. 特殊处理A(1)最大的情况
   - 排序时将1特殊处理为14
   - 使用元组(0 if x != 1 else 14, x)作为排序key
   
4. 按照大小顺序排序可能的组合
   - 三张牌组合降序排序
   - 对子降序排序

5. 遍历所有可能的组合
   - 跳过三张牌和对子相同的情况
   - 检查五张牌的和是否超过max
   - 找到的第一个合法组合就是最大的

## 代码实现

```python
def solution(n, max, array):
    # 统计每个数字出现的次数
    count_dict = {}
    for num in array:
        count_dict[num] = count_dict.get(num, 0) + 1
    
    # 找出所有可能的三张牌组合
    triples = []
    for num, count in count_dict.items():
        if count >= 3:
            triples.append(num)
    
    # 找出所有可能的对子组合
    pairs = []
    for num, count in count_dict.items():
        if count >= 2:
            pairs.append(num)
    
    # 如果没有足够的牌组成葫芦，返回[0, 0]
    if not triples or not pairs:
        return [0, 0]
    
    # 对triples和pairs按照牌面大小排序（考虑1是最大的）
    triples.sort(key=lambda x: (0 if x != 1 else 14, x), reverse=True)
    pairs.sort(key=lambda x: (0 if x != 1 else 14, x), reverse=True)
    
    # 找出最大的合法葫芦组合
    for triple in triples:
        for pair in pairs:
            # 跳过使用同一个数字的情况
            if triple == pair:
                continue
            # 计算牌面总和
            total = triple * 3 + pair * 2
            # 检查是否超过最大值
            if total > max:
                continue
            # 如果找到合法组合，直接返回（因为我们已经按照大小排序）
            return [triple, pair]
    
    return [0, 0]
```

## 复杂度分析

- 时间复杂度：O(n + k²)
  - n是输入数组的长度
  - k是不同牌面值的数量
  - 统计频次需要O(n)
  - 排序需要O(klogk)
  - 遍历组合需要O(k²)

- 空间复杂度：O(k)
  - k是不同牌面值的数量
  - 需要存储频次字典和可能的组合列表

## 易错点

1. 没有考虑A(1)是最大牌的特殊情况
2. 忘记检查五张牌的和是否超过max
3. 使用了相同的牌面值作为三张牌和对子
4. 没有按照正确的顺序比较不同的葫芦组合

## 相关题目

- 德州扑克其他牌型判断
- 纸牌游戏类问题
- 组合统计类问题
