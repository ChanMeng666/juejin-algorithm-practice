# 盘子叠放问题

## 题目描述

小M有一个特殊的盘子收纳方式。每次用餐后，他会按照以下规则整理盘子：

1. 所有盘子都有唯一的整数序号
2. 盘子在收纳前按序号递增排列
3. 叠放规则：
   - 每堆盘子的序号必须是连续递增的
   - 每堆至少要包含3个盘子
   - 不满足连续递增3个的盘子需要单独列出

要求编写程序，将盘子的叠放方式用特定格式输出：
- 连续3个及以上的序号用"起始号-结束号"表示
- 单独的序号直接列出
- 所有序号或序号范围之间用逗号分隔

### 输入格式
- plates: list[int] - 表示盘子序号的整数数组
- n: int - 盘子的总数量

### 输出格式
返回一个字符串，表示盘子的叠放方式

### 示例

**示例1：**
```python
输入：plates = [-3, -2, -1, 2, 10, 15, 16, 18, 19, 20], n = 10
输出："-3--1,2,10,15,16,18-20"
解释：
- [-3,-2,-1] 是连续的3个数，表示为"-3--1"
- [2] 是单个数，直接表示为"2"
- [10] 是单个数，表示为"10"
- [15,16] 是连续的2个数，因为不足3个，所以分别表示为"15,16"
- [18,19,20] 是连续的3个数，表示为"18-20"
```

**示例2：**
```python
输入：plates = [-6, -3, -2, -1, 0, 1, 3, 4, 5, 7, 8, 9, 10, 11, 14, 15, 17, 18, 19, 20], n = 20
输出："-6,-3-1,3-5,7-11,14,15,17-20"
```

**示例3：**
```python
输入：plates = [1, 2, 7, 8, 9, 10, 11, 19], n = 8
输出："1,2,7-11,19"
```

## 解题思路

### 1. 核心思想
使用双指针技术来追踪连续序列，同时用计数器记录连续序列的长度。

### 2. 具体步骤

1. **初始化**
   - 创建空结果列表`result`存储最终的字符串片段
   - 设置`start`和`end`指针指向第一个数字
   - 设置`count`计数器初始值为1

2. **遍历数组**
   - 从第二个数字开始遍历
   - 检查当前数字是否与前一个数字连续（差值为1）
   
3. **处理连续序列**
   - 如果数字连续：
     - 更新`end`指针
     - 增加计数器`count`
   - 如果数字不连续：
     - 处理之前的序列
     - 重置指针和计数器

4. **序列处理规则**
   - 如果序列长度≥3：
     - 使用"start-end"格式
   - 如果序列长度<3：
     - 将序列中的每个数字单独添加

5. **最终处理**
   - 处理最后一个序列
   - 用逗号连接所有结果

### 3. 代码实现

```python
def solution(plates: list[int], n: int) -> str:
    if not plates:
        return ""
    
    result = []
    start = end = plates[0]
    count = 1
    
    # 遍历所有数字找连续序列
    for i in range(1, len(plates)):
        if plates[i] == plates[i-1] + 1:
            end = plates[i]
            count += 1
        else:
            # 处理之前的序列
            if count >= 3:
                result.append(f"{start}-{end}")
            else:
                # 不足3个数的序列，单独添加每个数
                for j in range(start, end + 1):
                    result.append(str(j))
            # 重置计数
            start = end = plates[i]
            count = 1
    
    # 处理最后一个序列
    if count >= 3:
        result.append(f"{start}-{end}")
    else:
        for j in range(start, end + 1):
            result.append(str(j))
            
    return ",".join(result)
```

## 复杂度分析

- **时间复杂度**: O(n)，其中n是盘子的数量。我们需要遍历一次数组。
- **空间复杂度**: O(n)，在最坏情况下（没有连续序列），需要存储所有数字。

## 注意事项

1. 需要特别处理空输入的情况
2. 要注意处理最后一个序列
3. 负数序列的处理需要特别注意格式（如"-3--1"）
4. 确保输出格式严格符合要求，包括逗号分隔和范围表示

## 总结

这道题目主要考察了：
1. 数组的遍历和处理
2. 双指针技术的应用
3. 字符串的格式化和拼接
4. 边界条件的处理

掌握这道题目对于理解序列处理和字符串格式化都很有帮助。
